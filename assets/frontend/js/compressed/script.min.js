function ajax_update_cart(t,a){$.ajax({url:fUrl+"ajax_update_cart",type:"POST",cache:!1,dataType:"json",data:{csrf_hash:$.cookie("csrf_cookie_ci"),post_id:t,quantity:a},success:function(a){if(1==a.error)swal("Rất tiếc...",a.msg,"error");else{a.total_item<=99?$("#wrap_cart #cart_number").html(a.total_item):$("#wrap_cart #cart_number").html("99<plus>+</plus>");var e=$.number(a.sub_total,0,",",".");$(".wrap_item_"+t).find(".col_sub_total").find(".sub_total").children("span:last-child").html(e);var r=$.number(a.total,0,",",".");$(".wrap_giohang_tong").find(".total").html(r),$(".wrap_lbl_giohang").find(".number_item").html(a.total_item)}},error:function(){}})}function add_cart(){$(".add_cart").click(function(t){t.preventDefault();var a=0,e=new Array;$("body").find(".number_input").each(function(){var t=parseInt($(this).val());a+=t;var r=$(this).attr("data-id");e.push({post_id:r,number_item:a})}),a>0&&e.length>0&&$.ajax({url:fUrl+"ajax_add_cart",type:"POST",cache:!1,dataType:"json",data:{csrf_hash:$.cookie("csrf_cookie_ci"),arr_data:e},success:function(t){1==t.error?swal("Rất tiếc...",t.msg,"error"):(t.total_item<=99?$("#wrap_cart #cart_number").html(t.total_item):$("#wrap_cart #cart_number").html("99<plus>+</plus>"),swal("Cám ơn bạn!","Sản phẩm đã được thêm vào giỏ hàng.","success"))},error:function(){}})})}function number_input(t){$("body").on("keypress",t,function(t){var a=t.keyCode||t.which;return a>=48&&57>=a?!0:void t.preventDefault()}),$("body").on("keyup",t,function(t){var a=$(this),e=$.trim(a.val()).length;return 1==e&&"0"==a.val()&&a.val("1"),e>=5&&a.val(a.val().substr(0,4)),!0}),$("body").on("focus",t,function(t){var a=$(this);""==a.val()&&a.val("1")}),$("body").on("blur",t,function(t){var a=$(this),e=$.trim(a.val()).length;if(0==e?a.val("1"):e>=5&&a.val(a.val().substr(0,4)),in_cart){var r=a.attr("data-id"),o=a.val();ajax_update_cart(r,o)}}),$("body").on("change",t,function(t){var a=$(this),e=a.prev(),r=a.next(),o=parseInt(a.val());if(1>=o?e.attr("disabled","disabled"):o>=js_data.max_number_item_cart?r.attr("disabled","disabled"):(e.removeAttr("disabled"),r.removeAttr("disabled")),in_cart&&o<js_data.max_number_item_cart&&o>0){var i=a.attr("data-id"),n=o;ajax_update_cart(i,n)}}),$(".btn_increase").click(function(){var t=$(this),a=$(this).prev(),e=a.prev(),r=parseInt(a.val()),o=r+1;if(a.val(o),e.removeAttr("disabled"),r>=js_data.max_number_item_cart&&t.attr("disabled","disabled"),in_cart&&o<js_data.max_number_item_cart){var i=a.attr("data-id"),n=o;ajax_update_cart(i,n)}}),$(".btn_decrease").click(function(){var t=$(this),a=t.next(),e=a.next(),r=parseInt(a.val()),o=r-1;if(a.val(o),e.removeAttr("disabled"),1==o&&t.attr("disabled","disabled"),in_cart&&o>=1){var i=a.attr("data-id"),n=o;ajax_update_cart(i,n)}})}var document_height=$(document).height(),screen_height=$(window).height(),footer_height=$("#wrap_footer").height();$("#gotoTop").affix({offset:{bottom:footer_height+80}}),$(window).scroll(function(t){var a=$(window).scrollTop();a>=200?$("#gotoTop").fadeIn("fast"):$("#gotoTop").fadeOut("fast")}),$("body").on("click","#gotoTop",function(){$("html, body").animate({scrollTop:0},600,function(){$("#gotoTop").fadeOut("fast")})});var in_cart=!1;$("#wrap_giohang").length>0&&(in_cart=!0),$(document).ready(function(){$('[rel="popover"]').popover({container:"body",placement:"bottom",html:!0,content:function(){var t=$($(this).data("popover-content")).clone(!0).removeClass("hide");return t}}),$("#nav_sanpham").webuiPopover({url:"#nav_sanpham_popover",placement:"bottom-right",onShow:function(t){$("html, body").animate({scrollTop:0},600,function(){$("body").addClass("fixed"),$("#nav_sanpham_bg").fadeIn(100)})},onHide:function(t){$("body").removeClass("fixed"),$("#nav_sanpham_bg").fadeOut("fast")}}),$("#slick_hotline").slick({infinite:!0,lazyLoad:"ondemand",slidesToShow:4,slidesToScroll:1}),$("#slick_hot_product").slick({infinite:!0,lazyLoad:"ondemand",slidesToShow:3,slidesToScroll:1}),$("#slick_sale_product").slick({infinite:!0,lazyLoad:"ondemand",slidesToShow:3,slidesToScroll:1}),$(".elastislide-list").length>0&&$("#carousel").elastislide({orientation:"vertical",autoplay:!1,minItems:5}),$(".product_zoom").length>0&&($(".product_zoom").elevateZoom({zoomWindowWidth:400,zoomWindowHeight:400,zoomWindowOffetx:10}),$(".wrap_thumbnail").find("a").each(function(){$(this).click(function(t){t.preventDefault();var a=$(this).attr("data-large");$(".wrap_large_picture").find("img").attr("src",a).attr("data-zoom-image",a);var e=$(".product_zoom").data("elevateZoom"),r=a,o=a;e.swaptheimage(r,o)})})),$("div.wrap_paging").jPages({containerID:"related_products",perPage:3,previous:"",next:""}),$(".item_number").find('input[name="item_number"]').length>0&&(number_input(".number_input"),add_cart()),$("#wrap_giohang").length>0&&$(".wrap_giohang_item").find(".delete_item").click(function(t){t.preventDefault();var a=$(this).parent().parent(".wrap_giohang_item"),e=$(this).attr("data-id");$.ajax({url:fUrl+"ajax_delete_cart",type:"POST",cache:!1,dataType:"json",data:{csrf_hash:$.cookie("csrf_cookie_ci"),post_id:e},success:function(t){if(1==t.error)swal("Rất tiếc...",t.msg,"error");else{a.fadeOut("slow"),t.total_item<=99?($("#wrap_cart #cart_number").html(t.total_item),0==t.total_item&&$(".btn_dathang").remove()):$("#wrap_cart #cart_number").html("99<plus>+</plus>");var r=$.number(t.sub_total,0,",",".");$(".wrap_item_"+e).find(".col_sub_total").find(".sub_total").children("span:last-child").html(r);var o=$.number(t.total,0,",",".");$(".wrap_giohang_tong").find(".total").html(o),$(".wrap_lbl_giohang").find(".number_item").html(t.total_item)}},error:function(){}})})});