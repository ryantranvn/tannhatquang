if($(idTableList).length>0){var statusStr=":All;active:Active;inactive:Inactive";caption=captionButton(!0,!0),caption+=captionImport(currentModule.module),jQuery(idTableList).jqGrid({url:bUrl+currentModule.url+"/ajax_list?q=2",datatype:"json",height:"auto",autowidth:!0,shrinkToFit:!1,gridResize:!0,autoResizeAllColumns:!0,iconSet:"fontAwesome",colNames:["Status","Chuyên mục","Mã SP","Tên SP","Đơn vị","Số lượng","Tồn kho","Giá","Thứ tự","Hình","Action"],colModel:[{name:"status",index:"status",align:"center",width:"80",stype:"select",searchoptions:{sopt:["eq"],value:statusStr}},{name:"category",index:"category",search:!0,width:"100"},{name:"code",index:"code",search:!0,align:"center",width:"60"},{name:"name",index:"name",align:"left",search:!0,width:"150"},{name:"unit",index:"unit",align:"center",search:!0,width:"60"},{name:"quantity",index:"quantity",align:"right",search:!0,width:"60"},{name:"stock_in_trade",index:"stock_in_trade",align:"right",search:!0,width:"60"},{name:"price",index:"price",align:"right",search:!0,width:"60"},{name:"order",index:"order",align:"center",search:!0,width:"60",editable:!0,editoptions:{dataInit:function(e){setTimeout(function(){$(e).numeric()},100)}}},{name:"pictures",index:"pictures",align:"center",search:!1,width:"100"},{name:"act",index:"act",editable:!1,search:!1,width:"80",align:"center"}],rownumbers:!0,rowNum:defaultNumRows,rowList:[10,20,defaultNumRows],pager:idPager,sortname:"code",sortorder:"asc",toolbarfilter:!0,viewrecords:!0,gridComplete:function(){for(var e=jQuery(idTableList).jqGrid("getDataIDs"),t=0;t<e.length;t++){var a=e[t],r=jQuery(idTableList).jqGrid("getRowData",a),n="",n=formatButton(a,r.status,"btnStatus_","btnStatus","modalStatus"),i="";arr=r.pictures.split(","),void 0!=arr&&arr.length>0&&$.each(arr,function(e,a){i+='<a class="groupFancyBox" href="'+a+'" rel="image-'+t+'"><img src="'+a+'" class="smalThumbInTable" /></a>'});var u=btnEditInline(a)+bntDeleteInline(a);jQuery(idTableList).jqGrid("setRowData",e[t],{status:n,pictures:i,act:u})}click_btnInGrid("btnStatus","modalStatus",bUrl+currentModule.url+"/ajax_status",function(){location.reload()})},ajaxRowOptions:{async:!0},caption:caption,multiselect:!0,loadBeforeSend:function(){$(this).closest("div.ui-jqgrid-view").find("table.ui-jqgrid-htable>thead>tr>th").css({"text-align":"center"})},onSelectRow:function(e){}}),tableCommon(),$("body").on("click",".btnDelete",function(e){e.preventDefault(),href=$(this).attr("href"),showSmartAlert("Warning","<p>Are you sure delete this data ?</p>","[YES][NO]",function(){window.location.href=href},function(){})}),$("body").on("click","#btnMultiDelete",function(e){e.preventDefault(),href=$(this).attr("href"),selectedRows=jQuery(idTableList).jqGrid("getGridParam","selarrrow"),0==selectedRows.length?showSmartAlert("Error","Please select data.","[YES]"):showSmartAlert("Warning","<p>Are you sure delete this data ?</p>","[YES][NO]",function(){$("#ids").val(selectedRows),$("#frmTopButtons").submit()},function(){})}),$("a.groupFancyBox").fancybox()}if($("#frmProduct").length>0){justAlphaNum($("input[name=code_product]")),gen_url($('input[name="name_product"]'),$('input[name="url_product"]')),preventBeginWith("input[name=price_product]",48),preventBeginWith("input[name=price_product_sale]",48),preventBeginWith("input[name=price_product_sale_percent]",48),preventBeginWith("input[name=quantity_product]",48),$('input[name="code_product"]').limit("20","#code_product_limit"),$('input[name="manufacturer_product"]').limit("200","#manufacturer_product_limit"),$('input[name="name_product"]').limit("200","#name_product_limit"),$('input[name="url_product"]').limit("200","#url_product_limit"),$('textarea[name="desc_product"]').limit("1000","#desc_product_limit"),$("#have_sale").is(":checked")?($("#sale_wrap").show(),$('input[name="have_sale"]').val(1),$("input[name=price_product]").addClass("strikethrough")):($("#sale_wrap").hide(),$('input[name="have_sale"]').val(0),$("input[name=price_product]").removeClass("strikethrough"),$("input[name=price_product_sale]").val(""),$("input[name=price_product_sale_percent]").val("")),$("label[for=have_sale]").click(function(){$("#have_sale").is(":checked")?($("#sale_wrap").hide(),$('input[name="have_sale"]').val(0),$("input[name=price_product]").removeClass("strikethrough"),$("input[name=price_product_sale]").val(""),$("input[name=price_product_sale_percent]").val("")):($("#sale_wrap").show(),$('input[name="have_sale"]').val(1),$("input[name=price_product]").addClass("strikethrough"))}),preventLongMore_Number("input[name=price_product_sale_percent]",2),selectFile(".btnSelectThumbnail","images",!0,!1),$("body").on("click",".thumbnailDel",function(e){e.preventDefault(),thumbnailItem=$(this).parent(".thumbnailItem"),thumbnailWrapper=thumbnailItem.parent(".thumbnailWrapper"),inputThumbnail=thumbnailWrapper.prev().children(".inputThumbnail");var t=JSON.parse(inputThumbnail.val());1==t.length?inputThumbnail.val(""):(imgSrc=thumbnailItem.find("img").attr("src"),index=t.indexOf(imgSrc),t.splice(index,1),t.length>0&&inputThumbnail.val(JSON.stringify(t))),thumbnailItem.remove(),0==$(".thumbnailItem").length&&thumbnailWrapper.html("").html(defaultIMG)});var editor=CKEDITOR.replace("content_product",{entities_latin:!1,entities_greek:!1,toolbar:"Full"}),$validator=$("#frmProduct").validate({rules:{code_product:{required:!0,maxlength:20},name_product:{required:!0,maxlength:200},url_product:{required:!0,maxlength:200},desc_product:{maxlength:1e3}},messages:{code_product:{required:"Mã sản phẩm bắt buộc nhập",maxlength:"Tối đa 20 ký tự"},name_product:{required:"Name bắt buộc nhập",maxlength:"Tối đa 200 ký tự"},url_product:{required:"URL bắt buộc nhập",maxlength:"Tối đa 200 ký tự"},desc_product:{maxlength:"Tối đa 1000 ký tự"}},highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error").addClass("has-success")},errorElement:"span",errorClass:"help-block",errorPlacement:function(e,t){t.parent(".input-group").length?e.insertAfter(t.parent()):e.insertAfter(t)},submitHandler:function(e){return $.ajax({url:bUrl+"product/update",type:"POST",cache:!1,dataType:"json",data:{csrf_hash:$.cookie("csrf_cookie_ci"),id:$("input[name=id]").val(),code:$("input[name=code_product]").val(),manufacturer:$("input[name=manufacturer_product]").val(),name:$("input[name=name_product]").val(),url:$("input[name=url_product]").val(),desc:$('textarea[name="desc_product"]').val(),price:$("input[name=price_product]").val(),price_sale:$("input[name=price_product_sale]").val(),price_sale_percent:$("input[name=price_product_sale_percent]").val(),quantity:$("input[name=quantity_product]").val(),unit:$("input[name=unit_product]").val(),thumbnail:$("input[name=thumbnail]").val(),order:$("input[name=order]").val(),status:$("input[name=status]:checked").val(),category_id:$("input[name=selected_category_id]").val(),detail:editor.getData()},success:function(e){"1"==e.err?showSmartAlert("Error",e.msg,"[YES]"):window.location.href=bUrl+currentModule.url},error:function(){showSmartAlert("Error","Can send data. Please contact to admin.","[YES]")}}),!1}})}